# Orchestration: Pemulis (Systems Dev) — Structure Removal

**Date:** 2026-02-28T19:40:00Z  
**Agent:** Pemulis (Systems Dev)  
**Mode:** background  
**Task:** Remove structure placement, crafting, farming, turrets. PLACE_SHAPE is sole build mechanic.  
**Outcome:** ✅ SUCCESS

---

## What Happened

### Input
- Design directive from Hal: shapes-only build. Remove PLACE, CRAFT, FARM_HARVEST, recipes, structure inventory.

### Work
Modified 7 files to remove structures while keeping HQ, StructureState, and shapes:

**Removed:**
- `GameRoom.ts`: `handlePlace()`, `handleCraft()`, `handleFarmHarvest()`, farm tick simulation
- `GameRoom.ts`: Listeners for PLACE, CRAFT, FARM_HARVEST messages
- `shared/types.ts`: `workbenches`, `farmPlots`, `turrets` inventory fields from PlayerState
- `shared/data/recipes.ts`: Entire RECIPES, `canCraft()`, `getItemField()` logic
- `shared/messages.ts`: PLACE, CRAFT, FARM_HARVEST message types and payload interfaces
- `shared/constants.ts`: FARM, TURRET itemType constants
- `GameState.ts`: Workbench walkability check from `isWalkable()`
- `shared/index.ts`: Recipes export

**Kept:**
- `StructureState` and `structures` MapSchema (HQ via `spawnHQ()`)
- PLACE_SHAPE handler, all shape/territory logic
- ItemType.HQ, ItemType.Wall, ItemType.Floor (HQ still uses ItemType)
- `nextStructureId` (HQ ID generation)
- All resource fields (wood, stone, fiber, berries)

### Outcome
- 7 files modified
- Server and shared compile clean
- Tests: 150/151 passing (1 pre-existing creature AI flaky test)
- Build loop simplified: Gather → Spend wood on shapes → Expand territory

---

## Decision

**Structures and crafting removed.** Core game loop now: gather resources → place shapes → expand territory. HQ kept as bootstrap structure.

---

## Impact

- GameRoom API simplified: `handlePlaceShape()` is sole placement handler.
- Tests removed by Steeply (crafting, farming, structures): 39 tests deleted.
- No PLACE message validation needed on client anymore.
- Cascading: Gately removes InputHandler PLACE dispatch.
